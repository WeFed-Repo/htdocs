function Movie(d){this.oInpCode=d.inp;this.viewportWidth=d.vieW;this.viewportHeight=d.vieH;this.footerWidth=d.fooW;this.footerHeight=d.fooH;this.pictureWidth=300;this.pictureHeight=192;this.iconWidth=100;this.iconHeight=64;this.retro="/HT/IMAGES/PICTURECARD/Retro_carta.png";this.pictureSource=d.gal;this.map=new Array();var c=d.gal.length;var b=-Math.floor((c-1)/2);for(var a=0;a<c;a++){this.map.push(b++)}this.alpha=0.8;this.beta=0.8;this.kappa1=0.5;this.kappa2=1;this.gamma=0.8;this.delayV=35;this.delayH=50;this.delayF=50;this.frames=10;this.parab=new Object();this.parab.yo=0.25;this.parab.q=0}Movie.prototype.Xn=function(d){var b=this.footerWidth/2;if(d==0){return b}var c=d>0?d:-d;var a=this.iconWidth*(4*this.kappa2*((Math.pow(this.beta,c+1)-1)/(this.beta-1)-1)+(Math.pow(this.alpha,c)-1)/(this.alpha-1)+c*(1-4*this.kappa1))/4;if(d>0){return b+a}else{return b-a}};Movie.prototype.Yx=function(a){var b=this.parab.a+this.parab.b*a+this.parab.c*a*a;return b};Movie.prototype.Rn=function(b){b=Math.abs(b);var a=(1+Math.pow(this.alpha,b))/2;return a};Movie.prototype.OPAn=function(b){b=Math.abs(b);var a=0.25*(1+3*Math.pow(this.gamma,b));return a};Movie.prototype.Zn=function(b){b=b>0?b:-b;var a=Math.floor(10*(10-b));return a};Movie.prototype.sipario=function(c){$("#iol_sx").unbind();$("#iol_dx").unbind();$("#iol_foot").unbind();this.parab.a=this.parab.yo*this.footerHeight;this.parab.b=2*(2*this.parab.q+this.footerHeight-2*this.parab.a)/this.footerWidth;this.parab.c=-this.parab.b/this.footerWidth;var j=new Array();var m=this.pictureSource.length;for(var d=0;d<m;d++){var a=this.pictureSource[d].ico;var b=this.map[d];var g=this.Rn(b);var r=this.iconWidth*g;var o=this.iconHeight*g;var q=this.Xn(b);var f=this.Yx(q);var l=q-r/2;var i=f-o/2;var h=this.Zn(b);var p=this.OPAn(b);if(b==0){var e="<img id='iol_pic"+d+"' src='"+a+"' style='display:block; position:absolute; width:"+r+"px; height:"+o+"px; left:"+l+"px; bottom:"+i+"px;opacity:"+p+";filter: alpha(opacity="+100*p+"); z-index:"+h+"; border:2px solid #eee;'>"}else{var e="<img id='iol_pic"+d+"' src='"+a+"' style='display:block; position:absolute; width:"+r+"px; height:"+o+"px; left:"+l+"px; bottom:"+i+"px;opacity:"+p+";filter: alpha(opacity="+100*p+"); z-index:"+h+"; border:2px solid #ccc;'>"}j.push(e)}sHtml=j.join("");$("#iol_foot").html(sHtml);$("#iol_sx").fadeTo("normal",0.5);$("#iol_dx").fadeTo("normal",0.5);$("#iol_sx").bind("mouseover",this.showButtons);$("#iol_dx").bind("mouseover",this.showButtons);$("#iol_sx").bind("mouseout",this.halfButtons);$("#iol_dx").bind("mouseout",this.halfButtons);if(c){Movie.cb_arg=[this.frames,1,this];setTimeout(this.__upFrame,this.delayV,this.frames,1,this)}else{this.bind_play()}};Movie.prototype.cb_arg=[];Movie.prototype.getWheelDelta=function(c){if(c.wheelDelta){if(window.opera){var a=window.opera.version();var b=parseFloat(a);return(b<9.5?-c.wheelDelta:c.wheelDelta)}else{return c.wheelDelta}}else{return -c.detail*40}};Movie.prototype.bind_play=function(){$("#iol_sx").bind("click",this,this.play);$("#iol_dx").bind("click",this,this.play);$("#iol_foot").bind("click",this,this.play);$("#iol_foot").bind("mousewheel",this,this.play);$("#iol_foot").bind("DOMMouseScroll",this,this.play)};Movie.prototype.play=function(b){var c=b.target.id;var a=b.data;var k=function(){$("#iol_sx").unbind("click");$("#iol_dx").unbind("click");$("#iol_foot").unbind("click");$("#iol_foot").unbind("mousewheel");$("#iol_foot").unbind("DOMMouseScroll")};var g=function(n,m){k();Movie.cb_arg=[a.frames,1,n,m,a];setTimeout(a.__nextFrame,a.delayH,a.frames,1,n,m,a)};var d=function(m){k();Movie.cb_arg=[a.frames,1,a];setTimeout(a.__upFrame,a.delayV,a.frames,1,a)};var f=function(m){k();Movie.cb_arg=[a.frames,1,a];setTimeout(a.flip,a.delayF,a.frames,1,a)};var i=b.type;switch(i){case"click":switch(c){case"iol_sx":case"iol_sx_btn":if(a.map[0]>=0){var h=a.map.length;g(1-h,true)}else{g(+1,true)}break;case"iol_dx":case"iol_dx_btn":if(a.map[a.map.length-1]<=0){var h=a.map.length;g(h-1,true)}else{g(-1,true)}break}if(typeof c=="string"&&c.length>7&&c.substr(0,7)=="iol_pic"){var l=parseInt(c.substr(7));var j=l+a.map[0];if(j!=0){g(-j,false)}else{d()}}if(typeof c=="string"){switch(c){case"iol_old_pic":case"iol_des_pic":case"iol_des_tab":case"iol_des_txt":f();break}}break;case"mousewheel":case"DOMMouseScroll":var e=a.getWheelDelta(b);if(e>0){if(a.map[0]>=0){break}g(+1)}else{if(e<0){if(a.map[a.map.length-1]<=0){break}g(-1)}}}return false};Movie.prototype.__upFrame=function(e,d,h){$("#iol_old_pic").unbind("click");$("#iol_des_pic").unbind("click");if(typeof e=="undefined"){e=Movie.cb_arg[0];d=Movie.cb_arg[1];h=Movie.cb_arg[2]}var a=h.pictureSource.length;for(var r=0;r<a;r++){var p=h.map[r];if(p!=0){continue}h.cur=r;var t=document.getElementById("iol_old_pic");if(t!=null){var o=(e-d)/e;t.style.opacity=o;t.style.filter="alpha(opacity="+100*o+")";t.style.zIndex=1}if(d==1){var f=h.pictureSource[r].src;var l=h.iconWidth+d*(h.pictureWidth-h.iconWidth)/e;var c=l/h.pictureWidth;var q=h.pictureHeight*c;var s=h.viewportWidth/2;var b=h.viewportHeight/2*d/e;var m=s-l/2;var j=b-q/2;var g=500;var o=c;var i="<img id='iol_new_pic' src='"+f+"' style='display:block; position:absolute; width:"+l+"px; height:"+q+"px; left:"+m+"px; bottom:"+j+"px;opacity:"+o+";filter: alpha(opacity="+100*o+"); z-index:"+g+";'>";$("#iol_body").append(i)}else{var t=document.getElementById("iol_new_pic");var l=h.iconWidth+d*(h.pictureWidth-h.iconWidth)/e;var c=l/h.pictureWidth;var q=h.pictureHeight*c;var s=h.viewportWidth/2;var b=h.viewportHeight/2*d/e;var m=s-l/2;var j=b-q/2;var g=500;var o=c;t.style.width=l+"px";t.style.height=q+"px";t.style.left=m+"px";t.style.bottom=j+"px";t.style.opacity=o;t.style.filter="alpha(opacity="+100*o+")";t.style.zIndex=g}}if(++d<=e){Movie.cb_arg=[e,d,h];setTimeout(h.__upFrame,h.delayV,e,d,h)}else{$("#iol_old_pic").remove();$("#iol_des_pic").remove();t.id="iol_old_pic";h.oInpCode.value=h.pictureSource[h.cur].cod;h.face=0;h.flip=h.__flipCard_01;h.bind_play();$("#iol_old_pic").bind("click",h,h.play)}};Movie.prototype.__flipCard_01=function(f,g,b){$("#iol_old_pic").unbind("click");$("#iol_des_pic").unbind("click");if(typeof f=="undefined"){f=Movie.cb_arg[0];g=Movie.cb_arg[1];b=Movie.cb_arg[2]}var c=Math.PI*g/f;var h=document.getElementById("iol_old_pic");var a=b.pictureWidth*Math.cos(c);if(a>=0){var k=a;b.fronte=h.src}else{if(a<=0){k=-a;h.src=b.retro}}var j=b.viewportWidth/2;var i=j-k/2;h.style.width=k+"px";h.style.left=i+"px";if(++g<=f){Movie.cb_arg=[f,g,b];setTimeout(b.__flipCard_01,b.delayF,f,g,b)}else{var e=b.cur;var d=b.pictureSource[e].des;if(d===" "){b.flip=b.__flipCard_10}else{b.flip=b.__flipCard_12}b.face=1;b.bind_play();$("#iol_old_pic").bind("click",b,b.play)}};Movie.prototype.__flipCard_10=function(d,e,b){$("#iol_old_pic").unbind("click");$("#iol_des_pic").unbind("click");if(typeof d=="undefined"){d=Movie.cb_arg[0];e=Movie.cb_arg[1];b=Movie.cb_arg[2]}var c=Math.PI*e/d;var f=document.getElementById("iol_old_pic");var a=b.pictureWidth*Math.cos(c);if(a>=0){var i=a}else{if(a<=0){i=-a;f.src=b.fronte}}var h=b.viewportWidth/2;var g=h-i/2;f.style.width=i+"px";f.style.left=g+"px";if(++e<=d){Movie.cb_arg=[d,e,b];setTimeout(b.__flipCard_10,b.delayF,d,e,b)}else{b.flip=b.__flipCard_01;b.face=0;b.bind_play();$("#iol_old_pic").bind("click",b,b.play)}};Movie.prototype.__flipCard_12=function(e,f,a){$("#iol_old_pic").unbind("click");$("#iol_des_pic").unbind("click");if(typeof e=="undefined"){e=Movie.cb_arg[0];f=Movie.cb_arg[1];a=Movie.cb_arg[2]}var b=Math.PI*f/e;var g=document.getElementById("iol_old_pic");var i=document.getElementById("iol_des_pic");var m=a.pictureHeight*Math.cos(b);if(m>=0){var l=m;var h=a.viewportHeight/2;var j=h-l/2;g.style.height=l+"px";g.style.bottom=j+"px"}else{if(m<=0){l=-m;g.style.display="none";if(i==null){var d=a.cur;var c=a.pictureSource[d].des;$("#iol_body").append("<div id='iol_des_pic'><div id='iol_des_tab'><div id='iol_des_txt'>"+c+"</div></div></div>");i=document.getElementById("iol_des_pic");var o=a.pictureWidth;var n=a.viewportWidth/2;var k=n-o/2;i.style.width=o+"px";i.style.left=k+"px"}var h=a.viewportHeight/2;var j=h-l/2;i.style.height=l+"px";i.style.bottom=j+"px"}}if(++f<=e){Movie.cb_arg=[e,f,a];setTimeout(a.__flipCard_12,a.delayF,e,f,a)}else{a.face=2;a.flip=a.__flipCard_20;a.bind_play();$("#iol_des_pic").bind("click",a,a.play)}};Movie.prototype.__flipCard_20=function(c,g,a){$("#iol_old_pic").unbind("click");$("#iol_des_pic").unbind("click");if(typeof c=="undefined"){c=Movie.cb_arg[0];g=Movie.cb_arg[1];a=Movie.cb_arg[2]}var f=g/c;var j=document.getElementById("iol_old_pic");var m=a.pictureWidth*f;var e=a.pictureHeight*f;var p=a.viewportWidth/2;var q=a.pictureWidth;var n=p-q/2;var k=a.viewportHeight/2;var o=a.pictureHeight;var l=k-o/2;j.src=a.fronte;j.style.display="block";j.style.width=q+"px";j.style.height=o+"px";j.style.left=n+"px";j.style.bottom=l+"px";var i=(a.pictureHeight-e)/2;var d=(a.pictureHeight+e)/2;var b=(a.pictureWidth-m)/2;var h=(a.pictureWidth+m)/2;if(navigator.userAgent.indexOf("MSIE")>=0){j.style.clip="rect("+i+"px "+h+"px "+d+"px "+b+"px)"}else{j.style.clip="rect("+i+"px, "+h+"px, "+d+"px, "+b+"px)"}if(++g<=c){Movie.cb_arg=[c,g,a];setTimeout(a.__flipCard_20,a.delayF,c,g,a)}else{$("#iol_des_pic").remove();a.face=0;a.flip=a.__flipCard_01;a.bind_play();$("#iol_old_pic").bind("click",a,a.play)}};Movie.prototype.__nextFrame=function(d,c,m,u,g){if(typeof d=="undefined"){d=Movie.cb_arg[0];c=Movie.cb_arg[1];m=Movie.cb_arg[2];u=Movie.cb_arg[3];g=Movie.cb_arg[4]}var a=g.pictureSource.length;var q=m*(c/d);for(var r=0;r<a;r++){var o=g.map[r]+q;var t=document.getElementById("iol_pic"+r);var e=g.Rn(o);var i=g.iconWidth*e;var p=g.iconHeight*e;var s=g.Xn(o);var b=g.Yx(s);var j=s-i/2;var h=b-p/2;var l=g.OPAn(o);var f=g.Zn(o);t.style.width=i+"px";t.style.height=p+"px";t.style.left=j+"px";t.style.bottom=h+"px";t.style.opacity=l;t.style.filter="alpha(opacity="+100*l+")";t.style.zIndex=f;if(o==0){t.style.border="3px solid #eee"}else{t.style.border="3px solid #ccc"}}if(++c<=d){Movie.cb_arg=[d,c,m,u,g];setTimeout(g.__nextFrame,g.delayH,d,c,m,u,g)}else{for(var r=0;r<a;r++){g.map[r]+=m}if(u){Movie.cb_arg=[g.frames,1,g];setTimeout(g.__upFrame,g.delayH,g.frames,1,g)}else{g.bind_play()}}};Movie.prototype.showButtons=function(b){var a=b.target.id;switch(a){case"iol_sx":$("#iol_sx").fadeTo("normal",0.9);break;case"iol_dx":$("#iol_dx").fadeTo("normal",0.9);break}};Movie.prototype.halfButtons=function(c){var a=c.target.id;var b=c.relatedTarget?c.relatedTarget.id:null;switch(a){case"iol_sx":if(b=="iol_sx_btn"){break}$("#iol_sx").fadeTo("normal",0.5);break;case"iol_dx":if(b=="iol_dx_btn"){break}$("#iol_dx").fadeTo("normal",0.5);break;case"iol_body":$("#iol_sx").fadeTo("normal",0.5);$("#iol_dx").fadeTo("normal",0.5);break}};function openGallery(a,d){var b=function(g,f){if(!g){throw new Error(f)}};b(typeof a=="string","openGallery(): 1nd argument not string");b(d instanceof Array,"openGallery(): 2nd argument not Array");var e=document.getElementById(a);b(e!==null,"openGallery(): Element "+a+" does not exist");for(var c=0;c<d.length;c++){b(typeof d[c].src=="string","openGallery(): ["+c+"].src not valid");b(typeof d[c].ico=="string","openGallery(): ["+c+"].ico not valid");b(typeof d[c].cod=="string","openGallery(): ["+c+"].cod not valid")}iol_movie=new Movie({vieW:560,vieH:220,fooW:560,fooH:100,gal:d,inp:e});iol_movie.sipario(true)};