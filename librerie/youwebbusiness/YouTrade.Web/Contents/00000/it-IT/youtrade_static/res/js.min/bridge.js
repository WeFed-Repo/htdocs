function Bridge(){var n=!0,e=[],t=[],i=[],o=null;this.useAjaxComposition=!1;var c=function(n){return n+=n.indexOf("?")<0?"?":"&",n+="bodyOnly=true"},a=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()};this.initAjaxComposition=function(n){this.useAjaxComposition=!0,o=n},this.beforeLoading=function(n){e.push(n)},this.executeBeforeLoading=function(n){for(var t=0;t<e.length;t++)e[t](n)},this.ready=function(e){n?t.push(e):i.push(e)},this.executeOnReady=function(n){for(var e=0;e<t.length;e++)t[e](n);for(var e=0;e<i.length;e++)i[e](n)},this.redirect=function(n,e,t){this.useAjaxComposition?(n=c(n),this.dynamicLoad(n,$(o),null,e,t)):document.location.href=n},this.post=function(n,e,t){if(this.useAjaxComposition){var i=c(n.action),a=$(n).serialize();this.dynamicLoad(i,$(o),a,e,t)}else n.submit()};var s=function(n,e){return e&&e.content?void alert(e.content):void alert(n)};this.dynamicLoad=function(e,t,o,c,u){Bridge.instance.executeBeforeLoading(),n=!1,i=[],$(this).enginecommunication().enginecommunication("connect",{url:e,data:o,successHandler:function(n,e){try{$(t).html(e),a(),Bridge.instance.executeOnReady(),c&&c()}catch(i){console.log(i),s(i),u&&u()}},errorHandler:function(n,e,t,i,o){console.log(i),s(i,o),u&&u()}})}}Bridge.instance=new Bridge,$(document).ready(function(n){Bridge.instance.executeOnReady(n),Bridge.instance.useAjaxComposition&&(History.pushState(null,null,"./"),$(window).on("statechange",function(){document.location.href=""}))});