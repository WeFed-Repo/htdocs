<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>MIFID: Login in corso...</title>

    <script type="text/javascript">
    
    // Url di raccolta dati del post
    var url = {
        "login": "_test_iframemifid_post.php",
        "home": "_test_iframemifid_post.php"
    }

    /*
        Variabili per test in sviluppo/produzione
        var url = {
            "login" : "/tiQuestionario/Innesco",
            "home": "/tiQuestionario/index.jsp?2.1.16-SNAPSHOT"
        }

    */


    
    // XML da inviare: modificare qui le eventuali credenziali
    var xmlToPost = '<?xml version="1.0" encoding="UTF-8"?>'
        + '<root>'
            + '<parametri>'
                + '<param id="1"><paramNome>codiceFiscale</paramNome><paramValore></paramValore></param>'
                + '<param id="2"><paramNome>intestazione</paramNome><paramValore></paramValore></param>'
                + '<param id="3"><paramNome>dataDiNascita</paramNome><paramValore></paramValore></param>'
                + '<param id="4"><paramNome>codiceFiscale</paramNome><paramValore></paramValore></param>'
                + '<param id="5"><paramNome>intestazione</paramNome><paramValore></paramValore></param>'
                + '<param id="6"><paramNome>dataDiNascita</paramNome><paramValore></paramValore></param>'
                + '<param id="7"><paramNome>PROMOTORE</paraNome><paramValore>S</paramValore></param>'
                + '<param id="7"><paramNome>NDG</paramNome><paramValore></paramValore></param>'
                + '<param id="3"><paramNome>FUORISEDE</paramNome><paramValore>N</paramValore></param>'
                + '<param id="4"><paramNome>CABI</paramNome><paramValore>3102</paramValore></param>'
                + '<param id="4"><paramNome>codiceQuestionario</paramNome><paramValore></paramValore></param>'
                + '<param id="4"><paramNome>tipoOperazione</paramNome><paramValore>SIM</paramValore></param>'
                + '<param id="4"><paramNome>canale</paramNome><paramValore>Filiale</paramValore></param>'
                + '<param id="4"><paramNome>tipoOfferta</paramNome><paramValore>InSedeNormale</paramValore></param>'
                + '<param id="4"><paramNome>codicePromotore</paramNome><paramValore>12345</paramValore></param>'
                + '<param id="4"><paramNome>name</paramNome><paramValore>CICSUSER</paramValore></param>'
                + '<param id="4"><paramNome>password</paramNome><paramValore>CICSUSER</paramValore></param>'
                + '<param id="4"><paramNome>branch</paramNome><paramValore>1</paramValore></param>'
                + '<param id="7"><paramNome>debug</paramNome><paramValore>S</paramValore></param>'
            + '</parametri>'
        + '</root>';
    

    // Funzione di posting dell'XML
    var xmlPost = function(xml){
        
        var http = new XMLHttpRequest();
        http.open('POST', url["login"], true);
        http.setRequestHeader('Content-type', 'text/xml');
        http.onreadystatechange = function() {//Call a function when the state changes.
            if (http.readyState == 4) 
                if (http.status == 200) {
                    location = url["home"];
                } else {
                    alert ('Failed, http status ' + http.status);     
            }
        }
        http.send(xml)
    
    }

    // Evento di start per la login
    window.addEventListener("load", function(){xmlPost(xmlToPost)})

    </script>

    <style>

        body { background:#fff; text-align:center;margin:0;padding:0}

        @keyframes spin { 100% { transform:rotate(360deg); } }

        body::before {
            display:block;
            width:50px;
            height:50px;
            content:"";
            color:#ccc;
            position:fixed;
            border-top:solid 4px #ccc;
            border-left:solid 4px #ccc;
            border-right:solid 4px #ccc;
            border-bottom:solid 4px #fff;
            border-radius:50%;
            top: calc(50% - 25px);
            left: calc(50% - 25px);
            transform: rotate(0);
            animation: spin 4s linear infinite;

        }
        
    </style>
</head>
<body>
</body>
</html>